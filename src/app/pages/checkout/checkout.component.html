<section>
  <h2 class="title" style="font-weight: 900;text-align: center;">Thanh Toán</h2>
</section>

<section class="second-section">
  <div class="container">
    <div nz-row [nzGutter]="[24,24]">
      <div nz-col [nzSpan]="13">
        <div class="info">
          <div class="block">
            <h4 class="subtitle">Thông tin</h4>
            <div class="group">
              <app-box-address *ngIf="address_user_choosing" [info]="address_user_choosing"></app-box-address>
              <div class="btnChangeAddress" (click)="isMannageAddress=true">
                <span>Thay đổi địa chỉ giao hàng</span>
              </div>
            </div>
            <div class="group">
              <p class="label">Email: <b>(Trạng thái đơn hàng sẽ được gửi về email này)</b></p>
              <input nz-input placeholder="Email" [(ngModel)]="user.email" disabled/>
            </div>
          </div>

          <div class="block">
            <h4 class="subtitle">Phương thức thanh toán</h4>
            <div class="group">
              <nz-radio-group [(ngModel)]="bill.methodPayment">

                <label nz-radio nzValue="1">Thanh toán khi nhận hàng</label>
                <label nz-radio nzValue="2">Thanh toán bằng thẻ tín dụng</label>
              </nz-radio-group>
            </div>
          </div>

          <div class="block">
            <h4 class="subtitle">Điền thông tin thẻ</h4>
            <div class="group">
              <p class="label">Số thẻ:</p>
              <input nz-input placeholder="Địa chỉ" [(ngModel)]="user.card.serial" />
            </div>

            <div class="group">
              <div nz-row [nzGutter]="[24,24]">
                <div nz-col [nzSpan]="12">
                  <p class="label">Ngày hết hạn:</p>
                  <input nz-input placeholder="MM/YYYY" [(ngModel)]="user.card.date" />
                </div>
                <div nz-col [nzSpan]="12">
                  <p class="label">Mã CVV/CVC:</p>
                  <input nz-input placeholder="XXX" [(ngModel)]="user.card.code" />
                </div>
              </div>
            </div>
          </div>

          <div class="btnCheckout" (click)="submit()">
            <span>THANH TOÁN</span>
          </div>
        </div>
      </div>
      <div nz-col [nzSpan]="11">
        <div class="detail">
          <div class="block">
            <h4 class="subtitle">Sản phẩm</h4>
          </div>
          <div class="list-products">
            <div class="product" *ngFor="let product of products">
              <div class="left">
                <img src="https://cdn.shopify.com/s/files/1/0700/3193/3753/products/1_40d003d7-1668-439c-b798-ddfbaa3b90b0_64x64.png?v=1672651773" alt="">

              </div>
              <div class="center">
                <p class="name">{{product.name}}</p>
                <div>
                  <p class="size"><b>Kích cỡ: </b> {{product.size}}</p>
                  <p class="quantity"><b>Số lượng: </b> {{product.quantity}}</p>
                </div>
              </div>
              <div class="right">
                <div class="cost" *ngIf="product.sale>0"><span>{{main.formatPrice(product.cost)}}</span></div>
                <div class="price"><span>{{main.formatPrice((product.sale>0)?(product.cost-product.cost*(product.sale/100)):product.cost)}}</span> VND</div>



            </div>
            </div>
          </div>
        </div>
        <div class="total">
          <div class="group" style="margin-bottom: 20px;">
            <p class="label">Mã giảm giá:</p>
            <input nz-input placeholder="Mã giảm giá" [(ngModel)]="code_gift" />
          </div>
          <div class="group">
            <div class="inline">
              <b>Tạm tính:</b>
              <div>{{main.formatPrice(bill.subtotal)}} <span>VND</span></div>
            </div>
            <div class="inline">
              <b>Phí vận chuyển:</b>
              <div>{{main.formatPrice(bill.ship)}} <span>VND</span></div>
            </div>
            <div class="inline">
              <b>Giảm giá:</b>
              <div>{{bill.discount}} <span>VND</span></div>
            </div>
            <div class="inline" *ngIf="bill.discount>0">
              <b></b>
              <div class="cost">{{main.formatPrice(100000)}} <span>VND</span></div>
            </div>
            <div class="inline">
              <b>Tổng:</b>
              <div style="font-weight: 600;">{{main.formatPrice(bill.cost)}} <span>VND</span></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <app-manage-address *ngIf="user.id" [user]="{id:user.id,id_address_default:user.id_address_default}" (chooseEmitter)="chooseAddress($event)" [(visible)]="isMannageAddress"></app-manage-address>
</section>
